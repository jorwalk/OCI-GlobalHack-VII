{"version":3,"sources":["public/src/client/top.js"],"names":["define","recent","infinitescroll","Top","$","window","on","ev","data","ajaxify","currentPage","url","removeListeners","init","app","enterRoom","watchForNewPosts","handleCategorySelection","this","addClass","config","usePagination","loadMoreTopics","trigger","topics","direction","length","loadMore","after","attr","count","topicsPerPage","cid","utils","params","term","selectedTerm","filter","selectedFilter","done","onTopicsLoaded","nextStart","hide"],"mappings":"AAAA,aAEAA,OAAO,aAAc,eAAgB,wBAAyB,SAAUC,EAAQC,GAC/E,IAAIC,KAEJC,EAAEC,QAAQC,GAAG,uBAAwB,SAAUC,EAAIC,GAClD,GAAIC,QAAQC,cAAgBF,EAAKG,IAAK,CACrCV,EAAOW,qBAITT,EAAIU,KAAO,WACVC,IAAIC,UAAU,cAEdd,EAAOe,mBAEPf,EAAOgB,0BAEPb,EAAE,qBAAqBE,GAAG,QAAS,WAClCF,EAAEc,MAAMC,SAAS,UAGlB,IAAKC,OAAOC,cAAe,CAC1BnB,EAAeW,KAAKS,GAGrBlB,EAAEC,QAAQkB,QAAQ,wBAA0BC,OAAQf,QAAQD,KAAKgB,UAGlE,SAASF,EAAeG,GACvB,GAAIA,EAAY,IAAMrB,EAAE,0BAA0BsB,OAAQ,CACzD,OAGDxB,EAAeyB,SAAS,4BACvBC,MAAOxB,EAAE,0BAA0ByB,KAAK,kBACxCC,MAAOV,OAAOW,cACdC,IAAKC,MAAMC,SAASF,IACpBG,KAAM1B,QAAQD,KAAK4B,aAAaD,KAChCE,OAAQ5B,QAAQD,KAAK8B,eAAeD,QAClC,SAAU7B,EAAM+B,GAClB,GAAI/B,EAAKgB,QAAUhB,EAAKgB,OAAOE,OAAQ,CACtCzB,EAAOuC,eAAe,MAAOhC,EAAKgB,OAAQ,KAAMC,EAAWc,GAC3DnC,EAAE,0BAA0ByB,KAAK,iBAAkBrB,EAAKiC,eAClD,CACNF,IACAnC,EAAE,kBAAkBsC,UAKvB,OAAOvC","file":"public/src/client/top.js","sourcesContent":["'use strict';\n\ndefine('forum/top', ['forum/recent', 'forum/infinitescroll'], function (recent, infinitescroll) {\n\tvar\tTop = {};\n\n\t$(window).on('action:ajaxify.start', function (ev, data) {\n\t\tif (ajaxify.currentPage !== data.url) {\n\t\t\trecent.removeListeners();\n\t\t}\n\t});\n\n\tTop.init = function () {\n\t\tapp.enterRoom('top_topics');\n\n\t\trecent.watchForNewPosts();\n\n\t\trecent.handleCategorySelection();\n\n\t\t$('#new-topics-alert').on('click', function () {\n\t\t\t$(this).addClass('hide');\n\t\t});\n\n\t\tif (!config.usePagination) {\n\t\t\tinfinitescroll.init(loadMoreTopics);\n\t\t}\n\n\t\t$(window).trigger('action:topics.loaded', { topics: ajaxify.data.topics });\n\t};\n\n\tfunction loadMoreTopics(direction) {\n\t\tif (direction < 0 || !$('[component=\"category\"]').length) {\n\t\t\treturn;\n\t\t}\n\n\t\tinfinitescroll.loadMore('topics.loadMoreTopTopics', {\n\t\t\tafter: $('[component=\"category\"]').attr('data-nextstart'),\n\t\t\tcount: config.topicsPerPage,\n\t\t\tcid: utils.params().cid,\n\t\t\tterm: ajaxify.data.selectedTerm.term,\n\t\t\tfilter: ajaxify.data.selectedFilter.filter,\n\t\t}, function (data, done) {\n\t\t\tif (data.topics && data.topics.length) {\n\t\t\t\trecent.onTopicsLoaded('top', data.topics, true, direction, done);\n\t\t\t\t$('[component=\"category\"]').attr('data-nextstart', data.nextStart);\n\t\t\t} else {\n\t\t\t\tdone();\n\t\t\t\t$('#load-more-btn').hide();\n\t\t\t}\n\t\t});\n\t}\n\n\treturn Top;\n});\n"]}